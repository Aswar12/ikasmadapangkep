<?php\n\n// Debug script untuk test upload foto\n// Akses: https://ikasmadapangkep.test/debug-upload.php\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['test_photo'])) {\n    echo \"<h3>Debug Upload Foto</h3>\";\n    \n    $file = $_FILES['test_photo'];\n    \n    echo \"<h4>Info File:</h4>\";\n    echo \"Name: \" . $file['name'] . \"<br>\";\n    echo \"Size: \" . $file['size'] . \" bytes<br>\";\n    echo \"Type: \" . $file['type'] . \"<br>\";\n    echo \"Temp: \" . $file['tmp_name'] . \"<br>\";\n    echo \"Error: \" . $file['error'] . \"<br>\";\n    \n    if ($file['error'] === 0) {\n        $uploadDir = __DIR__ . '/storage/profile-photos/';\n        \n        echo \"<h4>Directory Info:</h4>\";\n        echo \"Upload Dir: $uploadDir<br>\";\n        echo \"Dir Exists: \" . (is_dir($uploadDir) ? 'Yes' : 'No') . \"<br>\";\n        echo \"Dir Writable: \" . (is_writable($uploadDir) ? 'Yes' : 'No') . \"<br>\";\n        \n        // Buat direktori jika belum ada\n        if (!is_dir($uploadDir)) {\n            if (mkdir($uploadDir, 0755, true)) {\n                echo \"Directory created successfully<br>\";\n            } else {\n                echo \"Failed to create directory<br>\";\n            }\n        }\n        \n        $filename = 'test_' . time() . '_' . basename($file['name']);\n        $targetPath = $uploadDir . $filename;\n        \n        echo \"<h4>Upload Test:</h4>\";\n        echo \"Target: $targetPath<br>\";\n        \n        if (move_uploaded_file($file['tmp_name'], $targetPath)) {\n            echo \"<span style='color: green;'>✅ Upload berhasil!</span><br>\";\n            echo \"File saved to: $targetPath<br>\";\n            \n            // Test akses via web\n            $webPath = '/storage/profile-photos/' . $filename;\n            echo \"Web URL: <a href='$webPath' target='_blank'>$webPath</a><br>\";\n            \n            // Display image\n            echo \"<img src='$webPath' style='max-width: 200px; margin-top: 10px;' alt='Uploaded'><br>\";\n        } else {\n            echo \"<span style='color: red;'>❌ Upload gagal!</span><br>\";\n            echo \"Error: \" . error_get_last()['message'] . \"<br>\";\n        }\n    } else {\n        echo \"<span style='color: red;'>File error: \" . $file['error'] . \"</span><br>\";\n    }\n}\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Debug Upload Foto</title>\n    <style>\n        body { font-family: Arial, sans-serif; padding: 20px; }\n        .container { max-width: 600px; }\n        input[type=\"file\"] { margin: 10px 0; }\n        button { padding: 10px 20px; background: #007cba; color: white; border: none; cursor: pointer; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h2>Debug Upload Foto Profile</h2>\n        <form method=\"POST\" enctype=\"multipart/form-data\">\n            <p>Pilih foto untuk test upload:</p>\n            <input type=\"file\" name=\"test_photo\" accept=\"image/*\" required>\n            <br>\n            <button type=\"submit\">Test Upload</button>\n        </form>\n        \n        <hr>\n        <h3>Info Server:</h3>\n        <p>PHP Version: <?php echo phpversion(); ?></p>\n        <p>Upload Max Filesize: <?php echo ini_get('upload_max_filesize'); ?></p>\n        <p>Post Max Size: <?php echo ini_get('post_max_size'); ?></p>\n        <p>Max File Uploads: <?php echo ini_get('max_file_uploads'); ?></p>\n        <p>Temp Directory: <?php echo sys_get_temp_dir(); ?></p>\n        \n        <h3>Storage Path Info:</h3>\n        <p>Storage Path: <?php echo __DIR__ . '/storage/profile-photos/'; ?></p>\n        <p>Storage Exists: <?php echo is_dir(__DIR__ . '/storage/profile-photos/') ? 'Yes' : 'No'; ?></p>\n        <p>Storage Writable: <?php echo is_writable(__DIR__ . '/storage/') ? 'Yes' : 'No'; ?></p>\n    </div>\n</body>\n</html>\n